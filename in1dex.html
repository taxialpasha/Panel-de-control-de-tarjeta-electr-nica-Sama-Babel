<!DOCTYPE html>
<html dir="rtl" lang="ar">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>نظام الكاشير المتكامل</title>
    <link rel="stylesheet" href="css/styles.css">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>

<body>
    <div class="app-container">
        <header class="app-header">
            <div class="logo">
                <img src="src/assets/icons/icon.png" alt="App Icon">
                <h1>نظام الكاشير</h1>
            </div>
            <div class="user-info">
                <span id="current-user">المستخدم: الإدارة</span>
                <span id="date-time"></span>
            </div>

            <div class="title-bar-buttons">
                <button id="minimize-btn" class="title-bar-button minimize-button" title="تصغير">
                    <i class="fas fa-minus"></i>
                </button>
                <button id="maximize-btn" class="title-bar-button maximize-button" title="تكبير">
                    <i class="fas fa-expand"></i>
                </button>
                <button id="close-btn" class="title-bar-button close-button" title="إغلاق">
                    <i class="fas fa-times"></i>
                </button>
            </div>
        </header>

        <main class="main-content">
            <!-- صفحة لوحة التحكم الرئيسية -->
            <section id="dashboard-page" class="page active">
                <h2>لوحة التحكم</h2>
                <div class="dashboard-widgets">
                    <div class="widget">
                        <div class="widget-header">
                            <h3>ملخص المبيعات</h3>
                        </div>
                        <div class="widget-content">
                            <div class="stats-item">
                                <span class="stats-label">المبيعات اليوم:</span>
                                <span class="stats-value" id="today-sales">0</span>
                                <span class="currency">د.ع</span>
                            </div>
                            <div class="stats-item">
                                <span class="stats-label">عدد الفواتير:</span>
                                <span class="stats-value" id="today-invoices">0</span>
                            </div>
                        </div>
                    </div>
                    <div class="widget">
                        <div class="widget-header">
                            <h3>أعلى المنتجات مبيعاً</h3>
                        </div>
                        <div class="widget-content">
                            <ul id="top-products" class="top-list">
                                <!-- سيتم تعبئة هذه القائمة ديناميكياً -->
                            </ul>
                        </div>
                    </div>
                    <div class="widget">
                        <div class="widget-header">
                            <h3>الأقساط المستحقة</h3>
                        </div>
                        <div class="widget-content">
                            <ul id="due-installments" class="due-list">
                                <!-- سيتم تعبئة هذه القائمة ديناميكياً -->
                            </ul>
                        </div>
                    </div>
                    <div class="widget">
                        <div class="widget-header">
                            <h3>المخزون المنخفض</h3>
                        </div>
                        <div class="widget-content">
                            <ul id="low-stock" class="warning-list">
                                <!-- سيتم تعبئة هذه القائمة ديناميكياً -->
                            </ul>
                        </div>
                    </div>
                </div>
            </section>

            <!-- صفحة المنتجات -->
            <section id="products-page" class="page">
                <h2>إدارة المنتجات</h2>
                <div class="action-bar">
                    <button id="add-product-btn" class="primary-btn"><i class="fas fa-plus"></i> إضافة منتج
                        جديد</button>
                    <button id="add-category-btn" class="secondary-btn"><i class="fas fa-folder-plus"></i> إضافة تصنيف
                        جديد</button>
                    <div class="search-container">
                        <input type="text" id="product-search" placeholder="بحث في المنتجات...">
                        <button id="search-btn"><i class="fas fa-search"></i></button>
                    </div>
                </div>
                <div class="products-container">
                    <div class="categories-panel">
                        <h3>التصنيفات</h3>
                        <ul id="categories-list" class="categories-list">
                            <li class="category-item active" data-category="all">جميع المنتجات</li>
                            <!-- سيتم تعبئة هذه القائمة ديناميكياً -->
                        </ul>
                    </div>
                    <div class="products-list-container">
                        <table id="products-table" class="data-table">
                            <thead>
                                <tr>
                                    <th>الرمز</th>
                                    <th>الاسم</th>
                                    <th>التصنيف</th>
                                    <th>السعر</th>
                                    <th>الكمية</th>
                                    <th>الإجراءات</th>
                                </tr>
                            </thead>
                            <tbody id="products-list">
                                <!-- سيتم تعبئة هذه القائمة ديناميكياً -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>

            <!-- صفحة المبيعات (الكاشير) -->
            <section id="sales-page" class="page">
                <h2>نقطة البيع</h2>
                <div class="sales-container">
                    <div class="products-panel">
                        <div class="search-container">
                            <input type="text" id="sale-product-search" placeholder="بحث / إدخال باركود...">
                            <button id="sale-search-btn"><i class="fas fa-search"></i></button>
                        </div>
                        <div class="categories-tabs" id="sale-categories">
                            <!-- سيتم تعبئة هذه القائمة ديناميكياً -->
                        </div>
                        <div class="product-grid" id="sale-products-grid">
                            <!-- سيتم تعبئة هذه القائمة ديناميكياً -->
                        </div>
                    </div>
                    <div class="invoice-panel">
                        <div class="invoice-header">
                            <h3>الفاتورة الحالية</h3>
                            <div class="invoice-info">
                                <span>رقم الفاتورة: <span id="invoice-number">-</span></span>
                                <span>التاريخ: <span id="invoice-date">-</span></span>
                            </div>
                        </div>
                        <div class="invoice-items">
                            <table class="invoice-table">
                                <thead>
                                    <tr>
                                        <th>المنتج</th>
                                        <th>السعر</th>
                                        <th>الكمية</th>
                                        <th>الإجمالي</th>
                                        <th>إزالة</th>
                                    </tr>
                                </thead>
                                <tbody id="invoice-items-list">
                                    <!-- سيتم تعبئة هذه القائمة ديناميكياً -->
                                </tbody>
                            </table>
                        </div>
                        <div class="invoice-summary">
                            <div class="summary-row">
                                <span class="summary-label">المجموع:</span>
                                <span class="summary-value" id="invoice-subtotal">0</span>
                                <span class="currency">د.ع</span>
                            </div>
                            <div class="summary-row">
                                <span class="summary-label">الخصم:</span>
                                <div class="discount-inputs">
                                    <input type="number" id="discount-value" min="0" placeholder="0">
                                    <select id="discount-type">
                                        <option value="percentage">%</option>
                                        <option value="fixed">د.ع</option>
                                    </select>
                                </div>
                            </div>
                            <div class="summary-row total-row">
                                <span class="summary-label">الإجمالي:</span>
                                <span class="summary-value" id="invoice-total">0</span>
                                <span class="currency">د.ع</span>
                            </div>
                        </div>
                        <div class="invoice-actions">
                            <button id="cash-payment-btn" class="primary-btn"><i class="fas fa-money-bill-wave"></i> دفع
                                نقدي</button>
                            <button id="installment-btn" class="secondary-btn"><i class="fas fa-clock"></i>
                                تقسيط</button>
                            <button id="clear-invoice-btn" class="danger-btn"><i class="fas fa-trash"></i> إلغاء
                                الفاتورة</button>
                        </div>
                    </div>
                </div>
            </section>

            <!-- صفحة الأقساط -->
            <section id="installments-page" class="page">
                <h2>إدارة الأقساط</h2>
                <div class="action-bar">
                    <div class="search-container">
                        <input type="text" id="installment-search" placeholder="بحث عن عميل...">
                        <button id="installment-search-btn"><i class="fas fa-search"></i></button>
                    </div>
                    <select id="installment-filter">
                        <option value="all">جميع الأقساط</option>
                        <option value="active">النشطة</option>
                        <option value="completed">المكتملة</option>
                        <option value="late">المتأخرة</option>
                    </select>
                </div>
                <div class="installments-container">
                    <table id="installments-table" class="data-table">
                        <thead>
                            <tr>
                                <th>رقم العقد</th>
                                <th>العميل</th>
                                <th>رقم الهاتف</th>
                                <th>المبلغ الكلي</th>
                                <th>القسط الشهري</th>
                                <th>المدفوع</th>
                                <th>المتبقي</th>
                                <th>الحالة</th>
                                <th>الإجراءات</th>
                            </tr>
                        </thead>
                        <tbody id="installments-list">
                            <!-- سيتم تعبئة هذه القائمة ديناميكياً -->
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- صفحة التقارير -->
            <section id="reports-page" class="page">
                <h2>التقارير</h2>
                <div class="reports-types">
                    <button data-report="sales" class="report-btn active">تقرير المبيعات</button>
                    <button data-report="inventory" class="report-btn">تقرير المخزون</button>
                    <button data-report="installments" class="report-btn">تقرير الأقساط</button>
                </div>
                <div class="report-filters">
                    <div class="date-filter">
                        <label for="start-date">من تاريخ:</label>
                        <input type="date" id="start-date">
                        <label for="end-date">إلى تاريخ:</label>
                        <input type="date" id="end-date">
                    </div>
                    <button id="generate-report-btn" class="primary-btn">إنشاء التقرير</button>
                    <button id="print-report-btn" class="secondary-btn"><i class="fas fa-print"></i> طباعة</button>
                    <button id="export-report-btn" class="secondary-btn"><i class="fas fa-file-export"></i>
                        تصدير</button>
                </div>
                <div class="report-content" id="report-content">
                    <!-- سيتم تعبئة هذا المحتوى ديناميكياً -->
                </div>
            </section>

            <!-- صفحة الحركات اليومية -->
            <section id="daily-page" class="page">
                <h2>الحركات اليومية</h2>
                <div class="action-bar">
                    <div class="date-filter">
                        <label for="daily-date">التاريخ:</label>
                        <input type="date" id="daily-date">
                    </div>
                    <button id="view-daily-btn" class="primary-btn">عرض</button>
                </div>
                <div class="daily-transactions">
                    <table id="daily-table" class="data-table">
                        <thead>
                            <tr>
                                <th>الوقت</th>
                                <th>نوع العملية</th>
                                <th>التفاصيل</th>
                                <th>المبلغ</th>
                                <th>المستخدم</th>
                            </tr>
                        </thead>
                        <tbody id="daily-list">
                            <!-- سيتم تعبئة هذه القائمة ديناميكياً -->
                        </tbody>
                    </table>
                </div>
                <div class="daily-summary">
                    <div class="summary-row">
                        <span class="summary-label">إجمالي المبيعات النقدية:</span>
                        <span class="summary-value" id="daily-cash-sales">0</span>
                        <span class="currency">د.ع</span>
                    </div>
                    <div class="summary-row">
                        <span class="summary-label">إجمالي المبيعات بالتقسيط:</span>
                        <span class="summary-value" id="daily-installment-sales">0</span>
                        <span class="currency">د.ع</span>
                    </div>
                    <div class="summary-row">
                        <span class="summary-label">إجمالي دفعات الأقساط:</span>
                        <span class="summary-value" id="daily-installment-payments">0</span>
                        <span class="currency">د.ع</span>
                    </div>
                    <div class="summary-row total-row">
                        <span class="summary-label">الإجمالي:</span>
                        <span class="summary-value" id="daily-total">0</span>
                        <span class="currency">د.ع</span>
                    </div>
                </div>
            </section>

            <!-- صفحة الإعدادات -->
            <section id="settings-page" class="page">
                <h2>الإعدادات</h2>
                <div class="settings-container">
                    <div class="settings-section">
                        <h3>إعدادات المتجر</h3>
                        <div class="form-group">
                            <label for="store-name">اسم المتجر:</label>
                            <input type="text" id="store-name" placeholder="اسم المتجر">
                        </div>
                        <div class="form-group">
                            <label for="store-phone">رقم الهاتف:</label>
                            <input type="text" id="store-phone" placeholder="رقم الهاتف">
                        </div>
                        <div class="form-group">
                            <label for="store-address">العنوان:</label>
                            <textarea id="store-address" placeholder="العنوان"></textarea>
                        </div>
                        <div class="form-group">
                            <label for="invoice-message">رسالة الفاتورة:</label>
                            <textarea id="invoice-message" placeholder="رسالة الترحيب والتوديع في الفاتورة"></textarea>
                        </div>
                    </div>
                    <div class="settings-section">
                        <h3>إعدادات النظام</h3>
                        <div class="form-group">
                            <label for="default-tax">الضريبة الافتراضية (%):</label>
                            <input type="number" id="default-tax" min="0" step="0.01" placeholder="0">
                        </div>
                        <div class="form-group">
                            <label for="default-interest">نسبة الفائدة الافتراضية للأقساط (%):</label>
                            <input type="number" id="default-interest" min="0" step="0.01" placeholder="0">
                        </div>
                        <div class="form-group">
                            <label for="stock-alert">تنبيه المخزون المنخفض:</label>
                            <input type="number" id="stock-alert" min="1" placeholder="5">
                        </div>
                    </div>
                    <div class="settings-section">
                        <h3>النسخ الاحتياطي واستعادة البيانات</h3>
                        <div class="backup-actions">
                            <button id="backup-btn" class="primary-btn"><i class="fas fa-download"></i> إنشاء نسخة
                                احتياطية</button>
                            <button id="restore-btn" class="secondary-btn"><i class="fas fa-upload"></i> استعادة
                                البيانات</button>
                            <input type="file" id="restore-file" class="hidden">
                        </div>
                    </div>
                    <div class="settings-actions">
                        <button id="save-settings-btn" class="primary-btn">حفظ الإعدادات</button>
                    </div>
                </div>
            </section>
        </main>

        <nav class="bottom-nav">
            <ul>
                <li data-page="dashboard-page" class="active">
                    <i class="fas fa-tachometer-alt"></i>
                    <span>الرئيسية</span>
                </li>
                <li data-page="products-page">
                    <i class="fas fa-box"></i>
                    <span>المنتجات</span>
                </li>
                <li data-page="sales-page">
                    <i class="fas fa-cash-register"></i>
                    <span>المبيعات</span>
                </li>
                <li data-page="installments-page">
                    <i class="fas fa-calendar-alt"></i>
                    <span>الأقساط</span>
                </li>
                <li data-page="reports-page">
                    <i class="fas fa-chart-bar"></i>
                    <span>التقارير</span>
                </li>
                <li data-page="daily-page">
                    <i class="fas fa-exchange-alt"></i>
                    <span>الحركات</span>
                </li>
                <li data-page="settings-page">
                    <i class="fas fa-cog"></i>
                    <span>الإعدادات</span>
                </li>
            </ul>
        </nav>
    </div>

    <!-- Modal للإضافة/التعديل للمنتجات -->
    <div id="product-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="product-modal-title">إضافة منتج جديد</h3>
                <span class="close-modal">&times;</span>
            </div>
            <div class="modal-body">
                <form id="product-form">
                    <div class="form-group">
                        <label for="product-code">رمز المنتج:</label>
                        <input type="text" id="product-code" required>
                    </div>
                    <div class="form-group">
                        <label for="product-name">اسم المنتج:</label>
                        <input type="text" id="product-name" required>
                    </div>
                    <div class="form-group">
                        <label for="product-category">التصنيف:</label>
                        <select id="product-category" required>
                            <!-- سيتم تعبئة هذه القائمة ديناميكياً -->
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="product-price">سعر البيع:</label>
                        <input type="number" id="product-price" min="0" step="0.01" required>
                    </div>
                    <div class="form-group">
                        <label for="product-cost">سعر التكلفة:</label>
                        <input type="number" id="product-cost" min="0" step="0.01" required>
                    </div>
                    <div class="form-group">
                        <label for="product-quantity">الكمية:</label>
                        <input type="number" id="product-quantity" min="0" required>
                    </div>
                    <div class="form-actions">
                        <button type="submit" class="primary-btn">حفظ</button>
                        <button type="button" class="secondary-btn close-btn">إلغاء</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Modal للإضافة/التعديل للتصنيفات -->
    <div id="category-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="category-modal-title">إضافة تصنيف جديد</h3>
                <span class="close-modal">&times;</span>
            </div>
            <div class="modal-body">
                <form id="category-form">
                    <div class="form-group">
                        <label for="category-name">اسم التصنيف:</label>
                        <input type="text" id="category-name" required>
                    </div>
                    <div class="form-actions">
                        <button type="submit" class="primary-btn">حفظ</button>
                        <button type="button" class="secondary-btn close-btn">إلغاء</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Modal للدفع النقدي -->
    <div id="cash-payment-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>الدفع النقدي</h3>
                <span class="close-modal">&times;</span>
            </div>
            <div class="modal-body">
                <div class="payment-summary">
                    <div class="summary-row">
                        <span class="summary-label">المبلغ المستحق:</span>
                        <span class="summary-value" id="cash-due-amount">0</span>
                        <span class="currency">د.ع</span>
                    </div>
                </div>
                <form id="cash-payment-form">
                    <div class="form-group">
                        <label for="cash-amount">المبلغ المدفوع:</label>
                        <input type="number" id="cash-amount" min="0" step="1" required>
                    </div>
                    <div class="summary-row">
                        <span class="summary-label">المبلغ المتبقي:</span>
                        <span class="summary-value" id="cash-remaining">0</span>
                        <span class="currency">د.ع</span>
                    </div>
                    <div class="form-actions">
                        <button type="submit" class="primary-btn">إتمام البيع</button>
                        <button type="button" class="secondary-btn close-btn">إلغاء</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Modal للتقسيط -->
    <div id="installment-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>بيع بالتقسيط</h3>
                <span class="close-modal">&times;</span>
            </div>
            <div class="modal-body">
                <div class="payment-summary">
                    <div class="summary-row">
                        <span class="summary-label">المبلغ الكلي:</span>
                        <span class="summary-value" id="installment-total-amount">0</span>
                        <span class="currency">د.ع</span>
                    </div>
                </div>
                <form id="installment-form">
                    <div class="form-group">
                        <label for="customer-name">اسم العميل:</label>
                        <input type="text" id="customer-name" required>
                    </div>
                    <div class="form-group">
                        <label for="customer-phone">رقم الهاتف:</label>
                        <input type="text" id="customer-phone" required>
                    </div>
                    <div class="form-group">
                        <label for="customer-address">العنوان:</label>
                        <input type="text" id="customer-address" required>
                    </div>
                    <div class="form-group">
                        <label for="down-payment">الدفعة الأولى:</label>
                        <input type="number" id="down-payment" min="0" step="1" required>
                    </div>
                    <div class="form-group">
                        <label for="installment-period">فترة التقسيط (شهور):</label>
                        <input type="number" id="installment-period" min="1" max="36" value="12" required>
                    </div>
                    <div class="form-group">
                        <label for="interest-rate">نسبة الفائدة (%):</label>
                        <input type="number" id="interest-rate" min="0" step="0.01" value="0">
                    </div>
                    <div class="installment-details">
                        <div class="summary-row">
                            <span class="summary-label">المبلغ بعد الفائدة:</span>
                            <span class="summary-value" id="amount-with-interest">0</span>
                            <span class="currency">د.ع</span>
                        </div>
                        <div class="summary-row">
                            <span class="summary-label">المبلغ المتبقي:</span>
                            <span class="summary-value" id="remaining-amount">0</span>
                            <span class="currency">د.ع</span>
                        </div>
                        <div class="summary-row">
                            <span class="summary-label">القسط الشهري:</span>
                            <span class="summary-value" id="monthly-installment">0</span>
                            <span class="currency">د.ع</span>
                        </div>
                    </div>
                    <div class="form-actions">
                        <button type="submit" class="primary-btn">تأكيد التقسيط</button>
                        <button type="button" class="secondary-btn close-btn">إلغاء</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Modal لدفع القسط -->
    <div id="pay-installment-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>دفع قسط</h3>
                <span class="close-modal">&times;</span>
            </div>
            <div class="modal-body">
                <div class="installment-info">
                    <div class="info-row">
                        <span class="info-label">العميل:</span>
                        <span class="info-value" id="payment-customer-name">-</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">رقم العقد:</span>
                        <span class="info-value" id="payment-contract-id">-</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">القسط الشهري:</span>
                        <span class="info-value" id="payment-monthly-amount">0</span>
                        <span class="currency">د.ع</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">المبلغ المتبقي:</span>
                        <span class="info-value" id="payment-remaining">0</span>
                        <span class="currency">د.ع</span>
                    </div>
                </div>
                <form id="installment-payment-form">
                    <div class="form-group">
                        <label for="payment-amount">المبلغ المدفوع:</label>
                        <input type="number" id="payment-amount" min="0" step="1" required>
                    </div>
                    <div class="form-group">
                        <label for="payment-date">تاريخ الدفع:</label>
                        <input type="date" id="payment-date" required>
                    </div>
                    <div class="form-group">
                        <label for="payment-notes">ملاحظات:</label>
                        <textarea id="payment-notes"></textarea>
                    </div>
                    <div class="form-actions">
                        <button type="submit" class="primary-btn">تأكيد الدفع</button>
                        <button type="button" class="secondary-btn close-btn">إلغاء</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <script src="js/utils.js"></script>
    <script src="js/inventory.js"></script>
    <script src="js/sales.js"></script>
    <script src="js/payments.js"></script>
    <script src="js/reports.js"></script>
    <script src="js/app.js"></script>
    <script src="js/window-control.js"></script>
    <head>
        <!-- الملفات الأساسية -->
        ...
        <!-- ملفات الأمان -->
        <link rel="stylesheet" href="css/security-styles.css">
        <script src="js/security.js"></script>
        <script src="js/user-management.js"></script>
        <script src="js/window-control-script.js"></script>
    </head>
</body>

</html>
